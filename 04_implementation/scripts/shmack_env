# This environment has to be sourced by all public scripts.
# It defines paths to files which are shared among scripts.

echo "Appliying shmack_env..."

if [ -f "./shmack_env" ] ; then
  export SCRIPTS_DIR=`pwd`
else 
  echo "Scripts must ALWAYS be executed with correct current directory, i.e. directory of 'shmack_env'"
  exit 99
fi

set -o pipefail

function run {
    "$@"
    local status=$?
    if [ $status -ne 0 ]; then
        echo "Failed to execute $*" >&2
	kill -9 $$ >> /dev/null
    fi
    return $status
}
export -f run

export SSH_KEY_LOCATION=${HOME}/shmack/shmack-key-pair-01.pem

export TARGET_DIR=${SCRIPTS_DIR}/target

export DCOS_INSTALL_DIR=${TARGET_DIR}/dcos

export TMP_OUTPUT_DIR=${TARGET_DIR}/tmp-output

export CURRENT_STATE_DIR=${TARGET_DIR}/current-state

export CURRENT_STACK_ID_FILE=${CURRENT_STATE_DIR}/StackId
export CURRENT_STACK_NAME_FILE=${CURRENT_STATE_DIR}/StackName
export CURRENT_MESOS_MASTER_DNS_FILE=${CURRENT_STATE_DIR}/MesosMasterDnsAddress
export CURRENT_PUBLIC_SLAVE_DNS_FILE=${CURRENT_STATE_DIR}/PublicSlaveDnsAddress

PATH=${SCRIPTS_DIR}:${PATH}
PATH=${SCRIPTS_DIR}/helpers:${PATH}
PATH=${PATH}:${DCOS_INSTALL_DIR}/bin
export PATH
